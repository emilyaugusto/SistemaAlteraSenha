<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <title>Painel de Suporte – Senha Recebida</title>
  <link rel="icon" href="imagens/Icon.png">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <link href="StyleAdmin.css" rel="stylesheet">
</head>
<body>

<h1>Painel de Suporte – Última Senha Recebida</h1>

<div class="senha-box">
  <div class="senha" id="mensagem">Aguardando mensagem...</div>
</div>

<br />

<div class="senha-box2">
  <input class="senha2" id="senhaInput" type="text" value="Carregando..." readonly />
</div>

<br />

<button onclick="copiarSenha()">Copiar Senha</button>

<br />

<img src="/imagens/FeitalLogo.png" alt="Grupo Feital" />

<script>
  let intervaloAtualizacao;

  async function buscarSenha() {
    const response = await fetch('/api/senha');
    const data = await response.json();
    const inputSenha = document.getElementById('senhaRecebida');
    inputSenha.value = data.senha;
  }

  function iniciarAtualizacao() {
    buscarSenha();
    intervaloAtualizacao = setInterval(buscarSenha, 2000); // atualiza a cada 2 segundos
  }

  function pararAtualizacao() {
    clearInterval(intervaloAtualizacao);
  }

  function copiarSenha() {
    const inputSenha = document.getElementById('senhaRecebida');
    navigator.clipboard.writeText(inputSenha.value).then(() => {
      document.getElementById('mensagem').innerText = 'Senha copiada!';
      inputSenha.value = '';
      pararAtualizacao(); // Para de atualizar depois de copiar
    });
  }

  // Abre o popup
  function abrirPopup() {
    document.getElementById('popup').style.display = 'block';
    document.getElementById('overlay').style.display = 'block';
  }

  // Fecha o popup
  function fecharPopup() {
    document.getElementById('popup').style.display = 'none';
    document.getElementById('overlay').style.display = 'none';
  }

  document.getElementById('overlay').addEventListener('click', fecharPopup);

  function irParaAdmin() {
    window.location.href = "/admin";
  }

  window.onload = iniciarAtualizacao;
</script>


</body>
</html>
